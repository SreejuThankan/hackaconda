<!doctype html>
<html>
<head>
    <title>Hackaconda!</title>
</head>

<body>

<div id="player1" style="background-color: black; padding:2px ; width:25px; height:25px; position:absolute"></div>

<div id="player2" style="background-color: blue; padding:2px ; width:25px; height:25px;position:absolute"></div>

<script src="/socket.io/socket.io.js"></script>
<script src="./bower_components/jquery/dist/jquery.js"></script><!--replace with jquery src in bower_components-->
<script>
    var socket = io();
    var playerId;
    socket.on('update position', function(players) {

        for (var key in players) {
            var playerElement = $('#player' + players[key].id);
            var player = players["player" + players[key].id];
            playerElement.css('top', player.y);
        playerElement.css('left', player.x);
    }
    });

    $.get(
       "/playerId",
       function(data) {
          playerId=data;
       }
    );



    var keyEvents = {
        37 : function() {
            this.emitMovePlayerEvent(playerId,"moveLeft");
             },
        39 : function(){
            this.emitMovePlayerEvent(playerId,"moveRight");
        },
        38 : function(){
            this.emitMovePlayerEvent(playerId,"moveUp");
        },
        40: function(){
            socket.emit(this.emitMovePlayerEvent(playerId,"moveDown"))
        },
        emitMovePlayerEvent : function(playerId, direction){
            socket.emit("movePlayer",{id:playerId, direction:direction});
        }

    };

    document.onkeyup = function(evt) {
        evt = evt || window.event;
        if(keyEvents.hasOwnProperty(evt.keyCode)) {
            keyEvents[evt.keyCode]();
        }
    };
</script>

</body>
</html>